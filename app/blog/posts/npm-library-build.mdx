---
title: "NPMì— ì½”ë“œ ë°°í¬í•˜ê¸°"
publishedAt: "2024-05-10"
---

# (1ì¥) NPMì— JavaScript ì½”ë“œ ë°°í¬í•˜ê¸°

## NPMì´ë€

JavaScriptë¡œ í”„ë¡ íŠ¸ì—”ë“œë‚˜ ë°±ì—”ë“œ ê°œë°œì„ í•˜ë‹¤ ë³´ë©´, ìì£¼ ì“°ëŠ” ê¸°ëŠ¥ì´ë‚˜ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ì„ ë§¤ë²ˆ í”„ë¡œì íŠ¸ì— ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ëŠ” ì¼ì´ ë§ìŠµë‹ˆë‹¤.

ì´ëŸ° ë°˜ë³µì„ ì¤„ì´ê³ , ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œë¥¼ ì¢€ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ë°”ë¡œ **NPM(Node Package Manager)** ì…ë‹ˆë‹¤.

ì‰½ê²Œ ë§í•´, ì €í¬ëŠ” ì§ì ‘ ë§Œë“  JavaScript ì½”ë“œë¥¼ NPMì— ì˜¬ë ¤ë‘ê³ , í•„ìš”í•œ í”„ë¡œì íŠ¸ì—ì„œ íŒ¨í‚¤ì§€ì²˜ëŸ¼ ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## NPM Serverì— íŒ¨í‚¤ì§€ ë°°í¬í•˜ê¸°

ì´ë²ˆì—ëŠ” ê°„ë‹¨í•œ JavaScript ëª¨ë“ˆì„ ë§Œë“¤ì–´ ì‹¤ì œë¡œ NPMì— ë°°í¬í•´ë³´ê² ìŠµë‹ˆë‹¤.

ë¨¼ì € package.json íŒŒì¼ì´ í•„ìš”í•©ë‹ˆë‹¤. í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ ì´ˆê¸° ì„¤ì •ì„ ì§„í–‰í•´ ì£¼ì„¸ìš”:

```bash
npm init
```

ê° í•­ëª©ì„ ì…ë ¥í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ëŠ”ë°, ì €ëŠ” íŒ¨í‚¤ì§€ ì´ë¦„ë§Œ ì…ë ¥í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ê·¸ëƒ¥ Enter í‚¤ë¡œ ë„˜ì–´ê°”ìŠµë‹ˆë‹¤. í•„ìš”í•œ ë¶€ë¶„ì€ ì¶”í›„ì— ìˆ˜ì •í•´ë„ ê´œì°®ìŠµë‹ˆë‹¤.

ì„±ê³µì ìœ¼ë¡œ ë§ˆì¹˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¬¼ì„ ì–»ê²Œ ë©ë‹ˆë‹¤:

```json
{
  "name": "tomato-spoon",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}
```

ê·¸ë¦¬ê³  `index.js`íŒŒì¼ì„ ë§Œë“  ë’¤ì— í•„ìš”í•œ ì½”ë“œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

```javascript
export function getName() {
  return "tomato-spoon";
}
```

ì, ì´ì œ í•„ìš”í•œ ì¤€ë¹„ëŠ” ëª¨ë‘ ëë‚¬ìŠµë‹ˆë‹¤. ì´ì œ ì§„ì§œ ë°°í¬ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.

ë¨¼ì € í„°ë¯¸ë„ì—ì„œ NPMì— ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.

```bash
npm login
```

ë¡œê·¸ì¸ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì´ì œ íŒ¨í‚¤ì§€ë¥¼ ë°°í¬í•  ì°¨ë¡€ì…ë‹ˆë‹¤.

> **(TMI)**

ë§Œì•½ íŒ¨í‚¤ì§€ ì´ë¦„ì— ë„¤ì„ìŠ¤í˜ì´ìŠ¤(ì˜ˆ: `@company/your-package`)ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´, ê¸°ë³¸ì ìœ¼ë¡œ ì´ íŒ¨í‚¤ì§€ëŠ” private(ë¹„ê³µê°œ) ìƒíƒœë¡œ ë°°í¬ë©ë‹ˆë‹¤. NPMì—ì„œ private íŒ¨í‚¤ì§€ëŠ” ìœ ë£Œ ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì—, ìš°ë¦¬ëŠ” ê³µê°œ(public) íŒ¨í‚¤ì§€ë¡œ ëª…ì‹œì ìœ¼ë¡œ ë°°í¬í•´ì•¼ í•©ë‹ˆë‹¤.

ê·¸ë˜ì„œ ë‹¤ìŒê³¼ ê°™ì´ --access=public ì˜µì…˜ì„ ì¶”ê°€í•´ì¤ë‹ˆë‹¤:

```bash
npm publish --access=public
```

```terminal
(base) josanghyeon@josanghyeon-ui-MacBookPro npm % npm publish --access=public
npm notice
npm notice ğŸ“¦  tomato-spoon@1.0.0
npm notice === Tarball Contents ===
npm notice 5B   README.md
npm notice 55B  index.js
npm notice 208B package.json
npm notice === Tarball Details ===
npm notice name:          tomato-spoon
npm notice version:       1.0.0
npm notice filename:      tomato-spoon-1.0.0.tgz
npm notice package size:  328 B
npm notice unpacked size: 268 B
npm notice shasum:        f22af6cfd5a8368e711f9ead472abc5d3b066829
npm notice integrity:     sha512-O0NwxZDRaW+7V[...]ROBn6Tp0rfIgg==
npm notice total files:   3
npm notice
npm notice Publishing to https://registry.npmjs.org/ with tag latest and public access
+ tomato-spoon@1.0.0
```

<img src="/images/1.png" alt="NPM í™”ë©´" />

ì, ì´ì œ ì´ ëª…ë ¹ì–´ í•˜ë‚˜ë§Œ ì…ë ¥í•˜ë©´ ë°©ê¸ˆ ë°°í¬í•œ ì†ŒìŠ¤ì½”ë“œë¥¼ ì–´ë””ì„œë“  ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
npm install tomato-spoon@1.0.0
```

[Source Code ë§í¬](https://github.com/eliot-liner/npm/tree/8d9a247584ff0526fe6e1237d1b7ead1d72ef640)

[NPM ë§í¬](https://www.npmjs.com/package/tomato-spoon)

# (2ì¥) ë°°í¬í•œ NPM ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ë‹¤?!

<a href="./npm-library-build">ì €ë²ˆ í¬ìŠ¤íŒ…</a>ì—ì„œ NPM ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë°°í¬í–ˆìŠµë‹ˆë‹¤.

ê·¸ë˜ì„œ install ëª…ë ¹ì–´ë¥¼ í†µí•´ ë§Œë“  ì†ŒìŠ¤ì½”ë“œë¥¼ ì–´ë””ì„œë“  ì‚¬ìš©í•  ìˆ˜ ìˆê²Œë˜ì—ˆìŠµë‹ˆë‹¤.

```bash
npm install tomato-spoon@1.0.0
```

í•˜ì§€ë§Œ ì´ NPM Packageë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë¬¸ì œê°€ í•˜ë‚˜ ë°œìƒí• ê²ë‹ˆë‹¤.

```terminal
SyntaxError: Unexpected token 'export'
```

(ì—ëŸ¬ ë©”ì‹œì§€ëŠ” í™˜ê²½ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)

ì—ëŸ¬ê°€ ë°œìƒí•œ ì´ìœ ëŠ” Module Resolution (ESM, CJS) ë°©ì‹ì´ ì¼ì¹˜í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì´ê²Œ ë¬´ìŠ¨ ë§ì¸ì§€ ì´í•´í•˜ê¸° ìœ„í•´ HTML, CSS, JavaScriptë§Œì„ ë‹¤ë£¨ë˜ ì‹œì ˆë¡œ ë‚´ë ¤ê°€ë³´ê² ìŠµë‹ˆë‹¤.

HTML, JavaScript íŒŒì¼ì„ ìƒì„±í•œ ë’¤ì— Script íƒœê·¸ë¥¼ í†µí•´ ë‘ íŒŒì¼ì„ ì—°ê²°ì‹œì¼œì£¼ì„¸ìš”.

```html:index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Hello World</h1>
    <script src="script.js"></script>
  </body>
</html>
```

```javascript:script.js
console.log("inject script!");
```

ì´ HTML íŒŒì¼ì„ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ í™”ë©´ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<img src="/images/2.png" alt="NPM í™”ë©´" />

í•˜ì§€ë§Œ ëª¨ë“  ì½”ë“œë¥¼ í•˜ë‚˜ì˜ íŒŒì¼ì— ì‘ì„±í•˜ê²Œ ë˜ë©´ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µê³  ë¶ˆí¸í•´ì§‘ë‹ˆë‹¤. ê·¸ë˜ì„œ ê¸°ëŠ¥ë³„ë¡œ íŒŒì¼ì„ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, getRandomNumber í•¨ìˆ˜ë¥¼ ë³„ë„ì˜ íŒŒì¼ë¡œ ë¶„ë¦¬í•œ ë’¤, ë‹¤ìŒê³¼ ê°™ì´ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```javascript:script.js
import { getRandomNumber } from "./random.js";

console.log("inject script!");
console.log(getRandomNumber());
```

```javascript:random.js
export const getRandomNumber = () => {
    return Math.random();
}
```

í•˜ì§€ë§Œ, ì´ ìƒíƒœì—ì„œ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ì‹œí‚¨ë‹¤ë©´ ì—ëŸ¬ë¥¼ ë§ˆì£¼í•˜ê²Œ ë©ë‹ˆë‹¤.

```terminal
Uncaught SyntaxError: Cannot use import statement outside a module (at script.js:1:1)
```

ì´ ì—ëŸ¬ê°€ ë°œìƒí•œ ì´ìœ ë¥¼ ì´í•´í•˜ë ¤ë©´, ìš°ë¦¬ê°€ importë¥¼ ì‚¬ìš©í•˜ê¸° ì „ ì‹œì ˆë¡œ ì ì‹œ ëŒì•„ê°€ ë³¼ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.

í˜„ì¬ì²˜ëŸ¼ import / exportë¥¼ ì´ìš©í•´ ëª¨ë“ˆì„ ê´€ë¦¬í•˜ëŠ” ë°©ì‹ì„ **ESM (ECMAScript Modules)** ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

ë°˜ë©´, ê³¼ê±°ì—ëŠ” requireì™€ module.exportsë¥¼ ì‚¬ìš©í•´ ëª¨ë“ˆì„ ë¶ˆëŸ¬ì™”ëŠ”ë°ìš”, ì´ ë°©ì‹ì„ **CJS (CommonJS)** ë¼ê³  í•©ë‹ˆë‹¤.

ESMì´ ë„ì…ëœ ì´í›„ì—ë„ ê¸°ì¡´ CJS ë°©ì‹ê³¼ì˜ í•˜ìœ„ í˜¸í™˜ì„ ìœ ì§€í•˜ê¸° ìœ„í•´, ë¸Œë¼ìš°ì €ì—ì„œ `<script>` íƒœê·¸ë¥¼ ì‚¬ìš©í•  ê²½ìš° ê¸°ë³¸ì ìœ¼ë¡œ CJS ìŠ¤íƒ€ì¼ì„ ë”°ë¥´ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```html:index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Hello World</h1>
    <!-- ì´ javascript íŒŒì¼ì€ cjsì…ë‹ˆë‹¤. -->
    <script src="script.js"></script>
  </body>
</html>
```

ê·¸ë˜ì„œ ë¬¸ì œê°€ ë°œìƒí•œ ì´ìœ ëŠ”, ë¸Œë¼ìš°ì €ì—ê²Œ ì´ JavaScript íŒŒì¼ì´ CJS ë°©ì‹ì´ë¼ê³  ì•”ë¬µì ìœ¼ë¡œ ì „ë‹¬ë˜ì—ˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” import / export ê°™ì€ ESM ë¬¸ë²•ì„ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì¶©ëŒì´ ë°œìƒí•œ ê²ƒì´ì£ .

ê²Œë‹¤ê°€ ìš”ì¦˜ ëŒ€ë¶€ë¶„ì˜ ìµœì‹  ë¸Œë¼ìš°ì €ëŠ” ESMì„ ê¸°ë³¸ìœ¼ë¡œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì—, ë°˜ëŒ€ë¡œ require()ë¥¼ ì‚¬ìš©í•´ë„ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

ì¦‰, ë¸Œë¼ìš°ì €ê°€ ì´ ìŠ¤í¬ë¦½íŠ¸ê°€ ESM ë¬¸ë²•ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆë„ë¡ ì„¤ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ `<script>` íƒœê·¸ì— type="module" ì†ì„±ì„ ì¶”ê°€í•´ì¤ë‹ˆë‹¤:

```html
<script src="script.js" type="module"></script>
```

ì´ë ‡ê²Œ í•˜ë©´ ë¸Œë¼ìš°ì €ëŠ” í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ESMìœ¼ë¡œ í•´ì„í•˜ê³ , import / export ë¬¸ë²•ì„ ì œëŒ€ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

<img src="/images/3.png" alt="NPM í™”ë©´" />

ì´ë ‡ê²Œ ë³€ê²½í•´ì¤€ë‹¤ë©´ ì €í¬ëŠ” ì›í•˜ëŠ” ê²°ê³¼ë¬¼ì„ ë°›ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ì‹œ NPM ì´ìŠˆë¡œ ëŒì•„ê°€ê² ìŠµë‹ˆë‹¤. `package.json`ì€ script íƒœê·¸ì™€ ê°™ì€ ì—­í• ì„ í•©ë‹ˆë‹¤.

ê·¸ë˜ì„œ ESM ë¬¸ë²•ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤ë©´ type="module"ì„ ëª…ì‹œí•´ì¤˜ì•¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```json
{
  "name": "tomato-spoon",
  "version": "1.0.1",
  "type": "module",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",
  "license": "ISC"
}
```

ì´ë ‡ê²Œ ìˆ˜ì •í•œ ë’¤ ë‹¤ì‹œ publishí•˜ë©´, ì²˜ìŒì— ë°œìƒí–ˆë˜ ì—ëŸ¬ëŠ” ë” ì´ìƒ ë‚˜íƒ€ë‚˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.

í•˜ì§€ë§Œ ESMë§Œ ì§€ì›í•˜ëŠ” ê²ƒì´ ë¬´ì¡°ê±´ ì¢‹ì€ ë°©í–¥ì´ë¼ê³ ëŠ” í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì‚¬ìš©ë  ê°€ëŠ¥ì„±ì´ ë†’ê¸° ë•Œë¬¸ì—, ê°€ëŠ¥í•˜ë‹¤ë©´ ESMê³¼ CJSë¥¼ ëª¨ë‘ ì§€ì›í•˜ëŠ” ê²ƒì´ ë” ë°”ëŒì§í•©ë‹ˆë‹¤.

ì´ë¥¼ Dual Packageë¼ê³  í•˜ëŠ”ë°, [Toss Tech Blog](https://toss.tech/article/commonjs-esm-exports-field)ì—ì„œë„ í•œ ë²ˆ ë‹¤ë£¬ ì ì´ ìˆë„¤ìš”.

ë‹¤ìŒ ê¸€ì—ì„œëŠ” ESM / CJS ë‘ ê°€ì§€ í™˜ê²½ì„ ëª¨ë‘ ì§€ì›í•´ì£¼ëŠ” NPM Moduleì„ ë§Œë“œëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ë‹¤ë¤„ë³´ê² ìŠµë‹ˆë‹¤.

## ë§ˆë¬´ë¦¬

ì²˜ìŒ ì´ ì—ëŸ¬ë¥¼ ë§ˆì£¼í–ˆì„ ë•ŒëŠ” ê½¤ ë‹¹í™©ìŠ¤ëŸ¬ì› ë˜ ê¸°ì–µì´ ë‚©ë‹ˆë‹¤.

importë¥¼ ì¨ë„ ì•ˆ ë˜ê³ , requireë¥¼ ì¨ë„ ëª¨ë“ˆì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ë‹¤ëŠ” ì—ëŸ¬ê°€ ê³„ì† ë–´ê±°ë“ ìš”.

í•˜ì§€ë§Œ ê³¼ê±°ì— stack overflowì—ì„œ í•´ê²°ì±…ì„ ë³¸ ë’¤ì— type="module"ì„ ë¶™ì—¬ì„œ í•´ê²°í–ˆë˜ ê¸°ì–µì´ ë‚¬ìŠµë‹ˆë‹¤. ã… -ã… 

ê·¸ë•Œ ì œëŒ€ë¡œ ì´í•´í•˜ì§€ ì•Šê³  ê·¸ëƒ¥ ë„˜ì–´ê°”ë˜ ê²Œ, ì˜¤íˆë ¤ ë” ë§ì€ ì‹œê°„ì„ ë‚­ë¹„í•˜ê²Œ ë§Œë“  ì›ì¸ì´ì—ˆë˜ ê²ƒ ê°™ì•„ìš”.

ì ê¹ë§Œ ê°œë…ì„ í™•ì‹¤íˆ ì§šê³  ê°”ë”ë¼ë©´ í›¨ì”¬ ë¹¨ë¦¬ í•´ê²°í•  ìˆ˜ ìˆì—ˆì„ í…ë° ë§ì´ì£ .

ì €ì™€ ê°™ì€ ìƒí™©ì„ ê²ªê³  ê³„ì‹  ë¶„ë“¤ì´ë¼ë©´, ì´ ë‚´ìš©ì„ ì •í™•íˆ ì´í•´í•˜ê³  ë§ì€ ì‹œê°„ì„ ì•„ë¼ì…¨ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤!

# (3ì¥) Dual Package ì§€ì›í•˜ê¸°

ì´ì „ í¬ìŠ¤íŒ…ì—ì„œëŠ” package.jsonì˜ type ì†ì„±ê³¼ ì‹¤ì œ ì‚¬ìš©í•œ Module Resolutionì´ ì¼ì¹˜í•˜ì§€ ì•Šì„ ë•Œ ë°œìƒí•˜ëŠ” ë¬¸ì œë¥¼ ì‚´í´ë´¤ìŠµë‹ˆë‹¤.

ì €ëŠ” ESMë§Œì„ ì§€ì›í•˜ë„ë¡ type: "module"ë¡œ ì„¤ì •í•´ì„œ, ESM ì „ìš© ëª¨ë“ˆì„ ë§Œë“¤ì—ˆëŠ”ë°ìš”. í•˜ì§€ë§Œ ì—¬ì „íˆ CJSë¥¼ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì´ ë§ê¸° ë•Œë¬¸ì—, ê°€ëŠ¥í•˜ë‹¤ë©´ ESMê³¼ CJS ëª¨ë‘ë¥¼ ì§€ì›í•´ì£¼ëŠ” ê²ƒì´ ë” ì‹¤ìš©ì ì…ë‹ˆë‹¤.

ì´ë¥¼ ìœ„í•´ì„œëŠ” ESMìœ¼ë¡œ ì‘ì„±í•œ JavaScript ì½”ë“œë¥¼ CJS ë°©ì‹ìœ¼ë¡œë„ ë³€í™˜í•´ì£¼ëŠ” ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.

ì´ ì‘ì—…ì„ ë„ì™€ì£¼ëŠ” íˆ´ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆì§€ë§Œ, ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ESBuildë¥¼ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.

ì¼ë‹¨ ESBuildë¥¼ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤.

```bash
npm i esbuild -D
```

```json
{
  "name": "tomato-spoon",
  "version": "1.0.1",
  "description": "",
  "main": "index.js",
  "type": "module",
  "scripts": {
    "publish": "npm publish --access=public",
    "build": "npm run cjs:build && npm run esm:build",
    "cjs:build": "esbuild index.js --outfile=dist/out.cjs --format=cjs",
    "esm:build": "esbuild index.js --outfile=dist/out.mjs --format=esm"
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "esbuild": "^0.25.4"
  }
}
```

ì´ë ‡ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•œ ë’¤ ì‹¤í–‰ì‹œì¼œì¤ë‹ˆë‹¤.

```bash
npm run build
```

ê·¸ëŸ¬ë©´ dist/ í´ë” í•˜ìœ„ì— cjs, mjs íŒŒì¼ì´ ìƒê¹ë‹ˆë‹¤.
í•˜ì§€ë§Œ ì´ë ‡ê²Œí•œ ë’¤ ì ì ˆí•œ íŒŒì¼ì´ ë§¤ì¹­ë˜ê²Œ í•˜ë ¤ë©´ package.jsonì—ë„ ìˆ˜ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.

```json
{
  "name": "tomato-spoon",
  "version": "1.0.1",
  "description": "",
  "main": "dist/out.cjs",
  "module": "dist/out.mjs",
  "scripts": {
    "publish": "npm publish --access=public",
    "build": "npm run cjs:build && npm run esm:build",
    "cjs:build": "esbuild index.js --outfile=dist/out.cjs --format=cjs",
    "esm:build": "esbuild index.js --outfile=dist/out.mjs --format=esm"
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "esbuild": "^0.25.4"
  }
}
```

ìœ„í—˜ì„±ì— ê´€ë ¨í•œ ë‚´ìš© ì¶”ê°€ì ìœ¼ë¡œ ì‘ì„±í•˜ê¸° (conditional export)

- https://lurgi.tistory.com/186

# (4ì¥) TypeScript ì§€ì›í•˜ê¸°

ì´ì „ í¬ìŠ¤íŒ…ì—ì„œëŠ” CJS, ESMì„ ëª¨ë‘ ì§€ì›í•´ì£¼ëŠ” Dual Packageë¥¼ ë§Œë“œëŠ” ë°©ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤.

TypeScript ì§€ì›ë„ í•œ ë²ˆ í•´ë³´ê² ìŠµë‹ˆë‹¤.

```terminal
tsc --init
```

ê·¸ë¦¬ê³  ê¸°ì¡´ì— ìˆë˜ íŒŒì¼ì„ TypescriptíŒŒì¼ë¡œ ë³€ê²½í•´ì¤ë‹ˆë‹¤.

```typescript:index.ts
export function getName(): string {
  return "tomato-spoon";
}
```

ESBuildë¡œ TypeScript ì§€ì›í•´ì£¼ë ¤ë©´ ì´ê²ƒì €ê²ƒ ì„¤ì •ì´ ì¢€ ê·€ì°®ì€ë°, ì´ê±¸ ê´œì°®ê²Œ í•´ì£¼ëŠ” tsupì´ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤.

ì´ë²ˆì—ëŠ” ì´ê±¸ í™œìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.

ì €ë²ˆì— ì„¤ì¹˜í–ˆë˜ ESBuildë¥¼ ì‚­ì œí•˜ê³  tsupì„ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤.

```terminal
npm uninstall esbuild
```

```terminal
npm install tsup typescript -D
```

```terminal
tsup src/index.ts src/cli.ts
```

```json
{
  "name": "tomato-spoon",
  "version": "1.0.2",
  "description": "",
  "main": "dist/index.js",
  "module": "dist/index.mjs",
  "types": "dist/index.d.ts",
  "scripts": {
    "deploy": "npm publish --access=public",
    "build": "npm run cjs:build && npm run esm:build",
    "cjs:build": "tsup index.ts --dts --format cjs",
    "esm:build": "tsup index.ts --format esm"
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "tsup": "^8.4.0",
    "typescript": "^5.8.3"
  }
}
```

ì´ë ‡ê²Œ ë³€ê²½í•˜ê³  ë°°í¬í•œë‹¤ë©´, ì´ì œ moduleì€ Typescriptë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

# (5ì¥) Platform Neutralë¡œ ë²ˆë“¤ ì‚¬ì´ì¦ˆ ìµœì í™”í•˜ê¸°

ì–¸ì  ê°€ ì ê² ìŠµë‹ˆë‹¤ :sad:
